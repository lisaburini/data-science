version: "3.1"

intents:
  - start
  - greet
  - goodbye
  - affirm
  - deny
  - mood_great
  - mood_unhappy
  - bot_challenge
  - insert_report
  - check_status_report
  - employees_info
  - office_info
  - specific_office_info
  - help
  - stop
  - out_of_scope
  - attack
  - submit
  - not_submit
  - insert_name
  - insert_surname
  - insert_phone_number
  - insert_email
  - insert_description
  - insert_location
  - suggestion_proposal
  

entities:
  - suggestion
  - description
  - location
  - full_name
  - phone_number
  - email
  - report_id
  - office
  - specific_area
  - employee_area
  - confirm_button

forms:
  check_status_form:
    required_slots:
      - report_id
  office_info_form:
    required_slots:
      - office
  employee_info_form:
    required_slots:
      - office
  insert_info_in_report:
    required_slots:
      - description
      - location
      - full_name
      - phone_number
      - email
  insert_suggestion:
    required_slots:
      - suggestion
      - full_name
      - phone_number
      - email
  ask_suggestion_form:
    required_slots:
      - confirm_button




slots:
  description:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: insert_info_in_report
            requested_slot: description
  location:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: insert_info_in_report
            requested_slot: location
  full_name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: insert_info_in_report
            requested_slot: full_name
          - active_loop: insert_suggestion
            requested_slot: full_name
  phone_number:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: insert_info_in_report
            requested_slot: phone_number
          - active_loop: insert_suggestion
            requested_slot: phone_number
  email:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: insert_info_in_report
            requested_slot: email
          - active_loop: insert_suggestion
            requested_slot: email
  suggestion:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: insert_suggestion
            requested_slot: suggestion

  report_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: check_status_form
            requested_slot: report_id
  office:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
          - active_loop: office_info_form
            requested_slot: office
          - active_loop: employee_info_form
            requested_slot: office
  
  specific_area:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: specific_area

  employee_area:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
          - active_loop: employee_info_form
            requested_slot: employee_area
  
  confirm_button:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
          - active_loop: ask_suggestion_form
            requested_slot: confirm_button

  
responses:
  
  utter_start:
  - text: "Benvenuto gentile cittadino. Io sono comunBot, il bot che mette in comunicazione i cittadini con il Comune di Montemarciano per raccogliere segnalazioni e dare informazioni."

  utter_greet:
  - text: "Salve, come posso aiutarti?"
  - text: "Buongiorno, sono a sua disposizione."

  utter_goodbye:
  - text: "Arrivederci"
  - text: "Arrivederla"
  - text: "Buon proseguimento di giornata"
  # - text: "Grazie di averci contattato"

  utter_mood_unhappy:
  - text: "Mi dispiace, spiegami meglio come posso esserti utile"
  
  utter_mood_great:
  - text: "Molto bene, sono soddisfatto per aver portato a termine il mio lavoro"
  - text: "Sono contento di aver soddisfatto tutte le sue esigenze."

  utter_happy:
  - text: "Ne sono lieto. Scrivimi pure tutte le volte che ne hai bisogno"
  - text: "Risolvere i problemi dei cittadini è il mio lavoro, sono felice di essere utile"

  utter_iamabot:
  - text: "Sono un bot"

  utter_out_of_scope:
  - text: "Mi dispiace, la sua richiesta non può essere soddisfatta. Ecco qui una lista delle attività di mia competenza:\n-Ricevere una segnalazione\n-Dare informazioni sullo stato di una segnalazione\n-Fornire informazioni inerenti al settore 'Lavori Pubblici', come orari di apertura al pubblico e contatti di riferimento"

  utter_fallback:
  - text: "Scusami, non ho compreso le sue intenzioni. Ecco qui una lista delle attività di mia competenza:\n-Ricevere una segnalazione\n-Dare informazioni sullo stato di una segnalazione\n-Fornire informazioni inerenti al settore 'Lavori Pubblici', come orari di apertura al pubblico e contatti di riferimento"

  utter_useful:
  - text: "Ho risposto correttamente alla sua domanda?"
  - text: "Ho fornito le informazioni richieste?"

  utter_attack:
  - text: "I nostri operatori stanno facendo il possibile. Provi a ricontattarci a breve."

  utter_employees_info:
  - text: ""
  # bottoni

  utter_insert_report:
  - text: "Bene: inserisci la descrizione della segnalazione"

  utter_ask_confirm:
  - text: "Si vuole procedere e registrare la segnalazione?"
  - text: "Posso inviare la segnalazione?"

  utter_submit:
  - text: "Ho registrato la segnalazione nel sistema. Sarà presa in carico al più presto. Ti ringraziamo."

  utter_not_submit:
  - text: "La segnalazione non è stata salvata."

  utter_ask_report_id:
  - text: "Qual è l'id della segnalazione di cui vuole controllare lo stato?"

  # utter_confirm_id:
  # - text: "Perfetto. Ora controllerò lo stato della segnalazione numero {report_id}."

  utter_help:
  - text: "Ecco qui una lista delle attività di mia competenza:\n-Ricevere una segnalazione\n-Dare informazioni sullo stato di una segnalazione\n-Fornire informazioni inerenti al settore 'Lavori Pubblici', come orari di apertura al pubblico e contatti di riferimento"

  utter_ask_other:
  - text: "Posso fare qualcos'altro per lei?"
  - text: "Ha bisogno di altro?"

  utter_ask_office:
  - text: "Quale area del settore 'Lavori Pubblici' le interessa?"
    buttons:
    - title: "Edilizia"
      payload: Edilizia
    - title: "Luce"
      payload: Pubblica Illuminazione
    - title: "Idraulica"
      payload: Termoidraulica
    - title: "Verde"
      payload: Verde Pubblico
    - title: "Viabilità"
      payload: Viabilità

  utter_ask_employee_area:
  - text: "Quale area del settore 'Lavori Pubblici' le interessa?"
    buttons:
    - title: "Edilizia"
      payload: Edilizia
    - title: "Luce"
      payload: Pubblica Illuminazione
    - title: "Idraulica"
      payload: Termoidraulica
    - title: "Verde"
      payload: Verde Pubblico
    - title: "Viabilità"
      payload: Viabilità

  utter_ask_description:
  - text: "Inserire l'oggetto della segnalazione:"

  utter_ask_location:
  - text: "Inserire la località della segnalazione:"

  utter_ask_full_name:
  - text: "Inserire il nominativo completo del segnalatore"

  utter_ask_phone_number:
  - text: "Fornire un recapito telefonico"

  utter_ask_email:
  - text: "Fornire l'indirizzo email"
  
  utter_ask_suggestion:
  - text: "Inserisca qui la sua proposta"

  utter_ask_confirm_button:
  - text: "Grazie per averci contattato. Vuole proporre dei consigli per il settore 'Lavori Pubblici' al fine di migliorare il servizio offerto ai cittadini?"
    buttons:
    - title: "Sì"
      payload: Sii
    - title: "No"
      payload: Noo


actions:
  - validate_check_status_form
  - check_status_db
  - get_office_info
  - get_specific_office_info
  - get_employees_info
  - submit_report
  - submit_suggestion
  - fill_slot
  - validate_insert_info_in_report
  - validate_insert_suggestion


session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

