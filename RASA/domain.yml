version: "3.1"

intents:
  - start
  - greet
  - goodbye
  - affirm
  - deny
  - mood_great
  - mood_unhappy
  - bot_challenge
  - insert_report
  - check_status_report
  - employees_info
  - office_info
  - help
  - stop
  - out_of_scope
  - attack
  - submit
  - not_submit
  - insert_name
  - insert_surname
  - insert_phone_number
  - insert_email
  - insert_description
  - insert_location
  

entities:
  - description
  - location
  - name
  - surname
  - phone_number
  - email
  - report_id
  - office

forms:
  check_status_form:
    required_slots:
      - report_id
  office_info_form:
    required_slots:
      - office


slots:
  description:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: description
  location:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: location
  name:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: name
  surname:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: surname
  phone_number:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: phone_number
  email:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: email

  report_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: check_status_form
            requested_slot: report_id
  office:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
          - active_loop: office_info_form
            requested_slot: office
        
  
responses:
  
  utter_start:
  - text: "Benvenuto gentile cittadino. Io sono comunBot, il bot che mette in comunicazione i cittadini con il Comune di Montemarciano per raccogliere segnalazioni o dare informazioni sulle stesse."

  utter_greet:
  - text: "Salve, come posso aiutarti?"
  - text: "Buongiorno, sono a tua disposizione."

  utter_goodbye:
  - text: "Arrivederci"
  - text: "Arrivederla"
  - text: "Buon proseguimento di giornata"
  - text: "Grazie di averci contattato"

  utter_mood_unhappy:
  - text: "Mi dispiace, spiegami meglio come posso esserti utile"
  
  utter_mood_great:
  - text: "Molto bene, sono soddisfatto per aver portato a termine il mio lavoro"
  - text: "Sono contento di aver soddisfatto tutte le sue esigenze."

  utter_happy:
  - text: "Ne sono lieto. Scrivimi pure tutte le volte che ne hai bisogno"
  - text: "Risolvere i problemi dei cittadini è il mio lavoro, sono felice di essere utile"

  utter_iamabot:
  - text: "Sono un bot"

  utter_out_of_scope:
  - text: "Scusami, non ho compreso le sue intenzioni. Ecco qui una lista delle attività di mia competenza:\n-Ricevere una segnalazione\n-Dare informazioni sullo stato di una segnalazione\n-Fornire informazioni inerenti al settore 'lavori pubblici'"

  utter_useful:
  - text: "Ho risposto correttamente alla tua domanda?"
  - text: "Ho fornito le informazioni richieste?"

  utter_attack:
  - text: "I nostri operatori stanno facendo il possibile. Provi a ricontattarci a breve."

  utter_employees_info:
  - text: ""
  # bottoni

  utter_insert_report:
  - text: "Bene: inserisci la descrizione della segnalazione"

  utter_ask_confirm:
  - text: "Si vuole procedere e registrare la segnalazione?"
  - text: "Posso inviare la segnalazione?"

  utter_submit:
  - text: "Ho registrato la segnalazione nel sistema. Sarà presa in carico al più presto. Ti ringraziamo."

  utter_not_submit:
  - text: "La segnalazione non è stata salvata."

  utter_insert_name:
  - text: "Il tuo nome è {name}"

  utter_insert_surname:
  - text: "Il tuo cognome è {surname}"

  utter_ask_report_id:
  - text: "Qual è l'id della segnalazione di cui vuole controllare lo stato?"

  # utter_confirm_id:
  # - text: "Perfetto. Ora controllerò lo stato della segnalazione numero {report_id}."

  utter_help:
  - text: "Ecco qui una lista delle attività di mia competenza:\n-Ricevere una segnalazione\n-Dare informazioni sullo stato di una segnalazione\n-Fornire informazioni inerenti al settore 'lavori pubblici'"

  utter_ask_other:
  - text: "Posso fare qualcos'altro per lei?"
  - text: "Ha bisogno di altro?"

  utter_ask_office:
  - text: "Quale area del settore 'Lavori Pubblici' le interessa?"
    buttons:
    - title: "Edilizia"
      # payload: /office_info{{"office":"Edilizia"}}
      payload: Edilizia
    - title: "Luce"
      # payload: /office_info{{"office":"Pubblica Illuminazione"}}
      payload: Pubblica Illuminazione
    - title: "Idraulica"
      # payload: /office_info{{"office":"Termoidraulica"}}
      payload: Termoidraulica
    - title: "Verde"
      # payload: /office_info{{"office":"Verde Pubblico"}}
      payload: Verde Pubblico
    - title: "Viabilità"
      # payload: /office_info{{"office":"Viabilità"}}
      payload: Viabilità


actions:
  - validate_check_status_form
  - check_status_db
  - get_office_info

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
